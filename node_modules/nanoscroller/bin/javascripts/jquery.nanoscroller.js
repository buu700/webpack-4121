(function(t){if(typeof define==="function"&&define.amd){return define(["jquery"],function(e){return t(e,window,document)})}else if(typeof exports==="object"){return module.exports=t(require("jquery"),window,document)}else{return t(jQuery,window,document)}})(function(t,e,i){"use strict";var s,n,o,r,l,h,c,a,p,f,u,d,g,v,S,m,T,y,b,w,x,$,H,C,O,A,E,Y,D,M,N;H={paneClass:"nano-pane",sliderClass:"nano-slider",contentClass:"nano-content",iOSNativeScrolling:false,preventPageScrolling:false,disableResize:false,alwaysVisible:false,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null};y="scrollbar";T="scroll";p="mousedown";f="mouseenter";u="mousemove";g="mousewheel";d="mouseup";m="resize";l="drag";h="enter";w="up";S="panedown";o="DOMMouseScroll";r="down";x="wheel";c="keydown";a="keyup";b="touchmove";s=e.navigator.appName==="Microsoft Internet Explorer"&&/msie 7./i.test(e.navigator.appVersion)&&e.ActiveXObject;n=null;E=e.requestAnimationFrame;$=e.cancelAnimationFrame;D=i.createElement("div").style;N=function(){var t,e,i,s,n,o;s=["t","webkitT","MozT","msT","OT"];for(t=n=0,o=s.length;n<o;t=++n){i=s[t];e=s[t]+"ransform";if(e in D){return s[t].substr(0,s[t].length-1)}}return false}();M=function(t){if(N===false){return false}if(N===""){return t}return N+t.charAt(0).toUpperCase()+t.substr(1)};Y=M("transform");O=Y!==false;C=function(){var t,e,s;t=i.createElement("div");e=t.style;e.position="absolute";e.width="100px";e.height="100px";e.overflow=T;e.top="-9999px";i.body.appendChild(t);s=t.offsetWidth-t.clientWidth;i.body.removeChild(t);return s};A=function(){var t,i,s;i=e.navigator.userAgent;t=/(?=.+Mac OS X)(?=.+Firefox)/.test(i);if(!t){return false}s=/Firefox\/\d{2}\./.exec(i);if(s){s=s[0].replace(/\D+/g,"")}return t&&+s>23};v=function(){function c(s,o){this.el=s;this.options=o;n||(n=C());this.$el=t(this.el);this.doc=t(this.options.documentContext||i);this.win=t(this.options.windowContext||e);this.body=this.doc.find("body");this.$content=this.$el.children("."+this.options.contentClass);this.$content.attr("tabindex",this.options.tabIndex||0);this.content=this.$content[0];this.previousPosition=0;if(this.options.iOSNativeScrolling&&this.el.style.WebkitOverflowScrolling!=null){this.nativeScrolling()}else{this.generate()}this.createEvents();this.addEvents();this.reset()}c.prototype.preventScrolling=function(t,e){if(!this.isActive){return}if(t.type===o){if(e===r&&t.originalEvent.detail>0||e===w&&t.originalEvent.detail<0){t.preventDefault()}}else if(t.type===g){if(!t.originalEvent||!t.originalEvent.wheelDelta){return}if(e===r&&t.originalEvent.wheelDelta<0||e===w&&t.originalEvent.wheelDelta>0){t.preventDefault()}}};c.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"});this.iOSNativeScrolling=true;this.isActive=true};c.prototype.updateScrollValues=function(){var t,e;t=this.content;this.maxScrollTop=t.scrollHeight-t.clientHeight;this.prevScrollTop=this.contentScrollTop||0;this.contentScrollTop=t.scrollTop;e=this.contentScrollTop>this.previousPosition?"down":this.contentScrollTop<this.previousPosition?"up":"same";this.previousPosition=this.contentScrollTop;if(e!=="same"){this.$el.trigger("update",{position:this.contentScrollTop,maximum:this.maxScrollTop,direction:e})}if(!this.iOSNativeScrolling){this.maxSliderTop=this.paneHeight-this.sliderHeight;this.sliderTop=this.maxScrollTop===0?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop}};c.prototype.setOnScrollStyles=function(){var t;if(O){t={};t[Y]="translate(0, "+this.sliderTop+"px)"}else{t={top:this.sliderTop}}if(E){if($&&this.scrollRAF){$(this.scrollRAF)}this.scrollRAF=E(function(e){return function(){e.scrollRAF=null;return e.slider.css(t)}}(this))}else{this.slider.css(t)}};c.prototype.createEvents=function(){this.events={down:function(t){return function(e){t.isBeingDragged=true;t.offsetY=e.pageY-t.slider.offset().top;if(!t.slider.is(e.target)){t.offsetY=0}t.pane.addClass("active");t.doc.bind(u,t.events[l]).bind(d,t.events[w]);t.body.bind(f,t.events[h]);return false}}(this),drag:function(t){return function(e){t.sliderY=e.pageY-t.$el.offset().top-t.paneTop-(t.offsetY||t.sliderHeight*.5);t.scroll();if(t.contentScrollTop>=t.maxScrollTop&&t.prevScrollTop!==t.maxScrollTop){t.$el.trigger("scrollend")}else if(t.contentScrollTop===0&&t.prevScrollTop!==0){t.$el.trigger("scrolltop")}return false}}(this),up:function(t){return function(e){t.isBeingDragged=false;t.pane.removeClass("active");t.doc.unbind(u,t.events[l]).unbind(d,t.events[w]);t.body.unbind(f,t.events[h]);return false}}(this),resize:function(t){return function(e){t.reset()}}(this),panedown:function(t){return function(e){t.sliderY=(e.offsetY||e.originalEvent.layerY)-t.sliderHeight*.5;t.scroll();t.events.down(e);return false}}(this),scroll:function(t){return function(e){t.updateScrollValues();if(t.isBeingDragged){return}if(!t.iOSNativeScrolling){t.sliderY=t.sliderTop;t.setOnScrollStyles()}if(e==null){return}if(t.contentScrollTop>=t.maxScrollTop){if(t.options.preventPageScrolling){t.preventScrolling(e,r)}if(t.prevScrollTop!==t.maxScrollTop){t.$el.trigger("scrollend")}}else if(t.contentScrollTop===0){if(t.options.preventPageScrolling){t.preventScrolling(e,w)}if(t.prevScrollTop!==0){t.$el.trigger("scrolltop")}}}}(this),wheel:function(t){return function(e){var i;if(e==null){return}i=e.delta||e.wheelDelta||e.originalEvent&&e.originalEvent.wheelDelta||-e.detail||e.originalEvent&&-e.originalEvent.detail;if(i){t.sliderY+=-i/3}t.scroll();return false}}(this),enter:function(t){return function(e){var i;if(!t.isBeingDragged){return}if((e.buttons||e.which)!==1){return(i=t.events)[w].apply(i,arguments)}}}(this)}};c.prototype.addEvents=function(){var t;this.removeEvents();t=this.events;if(!this.options.disableResize){this.win.bind(m,t[m])}if(!this.iOSNativeScrolling){this.slider.bind(p,t[r]);this.pane.bind(p,t[S]).bind(""+g+" "+o,t[x])}this.$content.bind(""+T+" "+g+" "+o+" "+b,t[T])};c.prototype.removeEvents=function(){var t;t=this.events;this.win.unbind(m,t[m]);if(!this.iOSNativeScrolling){this.slider.unbind();this.pane.unbind()}this.$content.unbind(""+T+" "+g+" "+o+" "+b,t[T])};c.prototype.generate=function(){var t,i,s,o,r,l,h;o=this.options;l=o.paneClass,h=o.sliderClass,t=o.contentClass;if(!(r=this.$el.children("."+l)).length&&!r.children("."+h).length){this.$el.append('<div class="'+l+'"><div class="'+h+'" /></div>')}this.pane=this.$el.children("."+l);this.slider=this.pane.find("."+h);if(n===0&&A()){s=e.getComputedStyle(this.content,null).getPropertyValue("padding-right").replace(/[^0-9.]+/g,"");i={right:-14,paddingRight:+s+14}}else if(n){i={right:-n};this.$el.addClass("has-scrollbar")}if(i!=null){this.$content.css(i)}return this};c.prototype.restore=function(){this.stopped=false;if(!this.iOSNativeScrolling){this.pane.show()}this.addEvents()};c.prototype.reset=function(){var t,e,i,o,r,l,h,c,a,p,f,u;if(this.iOSNativeScrolling){this.contentHeight=this.content.scrollHeight;return}if(!this.$el.find("."+this.options.paneClass).length){this.generate().stop()}if(this.stopped){this.restore()}t=this.content;o=t.style;r=o.overflowY;if(s){this.$content.css({height:this.$content.height()})}e=t.scrollHeight+n;p=parseInt(this.$el.css("max-height"),10);if(p>0){this.$el.height("");this.$el.height(t.scrollHeight>p?p:t.scrollHeight)}h=this.pane.outerHeight(false);a=parseInt(this.pane.css("top"),10);l=parseInt(this.pane.css("bottom"),10);c=h+a+l;u=Math.round(c/e*h);if(u<this.options.sliderMinHeight){u=this.options.sliderMinHeight}else if(this.options.sliderMaxHeight!=null&&u>this.options.sliderMaxHeight){u=this.options.sliderMaxHeight}if(r===T&&o.overflowX!==T){u+=n}this.maxSliderTop=c-u;this.contentHeight=e;this.paneHeight=h;this.paneOuterHeight=c;this.sliderHeight=u;this.paneTop=a;this.slider.height(u);this.events.scroll();this.pane.show();this.isActive=true;if(t.scrollHeight===t.clientHeight||this.pane.outerHeight(true)>=t.scrollHeight&&r!==T){this.pane.hide();this.isActive=false}else if(this.el.clientHeight===t.scrollHeight&&r===T){this.slider.hide()}else{this.slider.show()}this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""});i=this.$content.css("position");if(i==="static"||i==="relative"){f=parseInt(this.$content.css("right"),10);if(f){this.$content.css({right:"",marginRight:f})}}return this};c.prototype.scroll=function(){if(!this.isActive){return}this.sliderY=Math.max(0,this.sliderY);this.sliderY=Math.min(this.maxSliderTop,this.sliderY);this.$content.scrollTop(this.maxScrollTop*this.sliderY/this.maxSliderTop);if(!this.iOSNativeScrolling){this.updateScrollValues();this.setOnScrollStyles()}return this};c.prototype.scrollBottom=function(t){if(!this.isActive){return}this.$content.scrollTop(this.contentHeight-this.$content.height()-t).trigger(g);this.stop().restore();return this};c.prototype.scrollTop=function(t){if(!this.isActive){return}this.$content.scrollTop(+t).trigger(g);this.stop().restore();return this};c.prototype.scrollTo=function(t){if(!this.isActive){return}this.scrollTop(this.$el.find(t).get(0).offsetTop);return this};c.prototype.stop=function(){if($&&this.scrollRAF){$(this.scrollRAF);this.scrollRAF=null}this.stopped=true;this.removeEvents();if(!this.iOSNativeScrolling){this.pane.hide()}return this};c.prototype.destroy=function(){if(!this.stopped){this.stop()}if(!this.iOSNativeScrolling&&this.pane.length){this.pane.remove()}if(s){this.$content.height("")}this.$content.removeAttr("tabindex");if(this.$el.hasClass("has-scrollbar")){this.$el.removeClass("has-scrollbar");this.$content.css({right:""})}return this};c.prototype.flash=function(){if(this.iOSNativeScrolling){return}if(!this.isActive){return}this.reset();this.pane.addClass("flashed");setTimeout(function(t){return function(){t.pane.removeClass("flashed")}}(this),this.options.flashDelay);return this};return c}();t.fn.nanoScroller=function(e){return this.each(function(){var i,s;if(!(s=this.nanoscroller)){i=t.extend({},H,e);this.nanoscroller=s=new v(this,i)}if(e&&typeof e==="object"){t.extend(s.options,e);if(e.scrollBottom!=null){return s.scrollBottom(e.scrollBottom)}if(e.scrollTop!=null){return s.scrollTop(e.scrollTop)}if(e.scrollTo){return s.scrollTo(e.scrollTo)}if(e.scroll==="bottom"){return s.scrollBottom(0)}if(e.scroll==="top"){return s.scrollTop(0)}if(e.scroll&&e.scroll instanceof t){return s.scrollTo(e.scroll)}if(e.stop){return s.stop()}if(e.destroy){return s.destroy()}if(e.flash){return s.flash()}}return s.reset()})};t.fn.nanoScroller.Constructor=v});